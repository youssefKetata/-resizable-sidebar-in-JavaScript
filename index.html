<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Resizable Sidebar</title>
  </head>
  <body>
    <div class="container">
      <div class="sidebar">
        <div class="sidebar-header">
          <h3>sidebar</h3>
          <button
            rule="button"
            class="collapse_icon"
            aria-label="collapse button"
          >
            <svg
              xmlns:xlink="http://www.w3.org/1999/xlink"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                fill="#666666"
                fill-rule="evenodd"
                d="M19 4.001H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-12a2 2 0 0 0-2-2Zm-15 2a1 1 0 0 1 1-1h4v14H5a1 1 0 0 1-1-1v-12Zm6 13h9a1 1 0 0 0 1-1v-12a1 1 0 0 0-1-1h-9v14Z"
                clip-rule="evenodd"
              ></path>
            </svg>
          </button>
        </div>
        <ul>
          <li>Home<span>5</span></li>
          <hr />
          <li>Home</li>
          <hr />
          <li>Home</li>
          <hr />
          <li>Home<span>5</span></li>
        </ul>
      </div>
      <div class="resize-handle"></div>
      <div class="content">
        <h3 class="main_content-title">main content</h3>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do
          eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
          minim veniam, quis nostrud exercitation ullamco laboris nisi ut
          aliquip ex ea commodo consequat. Duis aute irure dolor in
          reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
          pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
          culpa qui officia deserunt mollit anim id est laborum.
        </p>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do
          eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
          minim veniam, quis nostrud exercitation ullamco laboris nisi ut
          aliquip ex ea commodo consequat. Duis aute irure dolor in
          reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
          pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
          culpa qui officia deserunt mollit anim id est laborum.
        </p>
      </div>
    </div>
  </body>

  <script>
    const sidebar = document.querySelector(".sidebar");
    const resizeHandle = document.querySelector(".resize-handle");
    const container = document.querySelector(".container");
    let content = document.querySelector(".content");
    // Set minimum and maximum width if the sidebar
    const minWidth = 150; // Adjust minimum width in px
    const maxWidth = 360; // Adjust maximum width in px

    let isResizing = false;
    let startWidth = 0;
    let startCursorX = 0;
    let paddingInline = 0;
    let originalContentPadding = ""; // Store the original content padding

    const hideMargin = -60;
    const showMargin = 12;

    function handleMouseDown(event) {
      event.preventDefault();
      isResizing = true;
      const style = getComputedStyle(sidebar);
      startWidth =
        sidebar.clientWidth -
        parseFloat(style.paddingLeft) -
        parseFloat(style.paddingRight);
      startCursorX = event.clientX;
    }

    function handleMouseUp() {
      isResizing = false;
    }

    function handleMouseMove(event) {
      if (!isResizing) return;

      const deltaX = event.clientX - startCursorX;
      const newWidth = startWidth + deltaX;

      sidebar.style.width =
        Math.min(Math.max(newWidth, minWidth), maxWidth) + "px";
    }

    // Collapse sidebar
    let collapseIcon = document.querySelector(".collapse_icon");
    function handleCollapse() {
      let style = getComputedStyle(sidebar);
      let sidebar_marginLeft = parseInt(style.marginLeft);

      // on mobile view
      const width = sidebar.clientWidth;
      if (window.innerWidth < 750) mobile_sidebar(width);
      else {
        if (sidebar_marginLeft === 0) {
          sidebar.style.marginLeft = `-${width}px`; // hide sidebar
          collapseIcon.style.marginRight = hideMargin + "px"; // move collapse icon to the right
          resizeHandle.style.display = "none"; // hide resize handle
        } else {
          collapseIcon.style.marginRight = showMargin + "px";
          sidebar.style.marginLeft = "0px";
          resizeHandle.style.display = "block";
        }
      }
    }

    function mobile_sidebar(width) {
      // se if the side bar is hidden or not
      if (sidebar.style.marginLeft === "0px") {
        console.log("sidebar is hidden");
        sidebar.style.marginLeft = `-${width}px`; // hide sidebar
        collapseIcon.style.marginRight = hideMargin + "px"; // move collapse icon to the right
        let overlay = document.querySelector(".overlay");
        container.removeChild(overlay);
      } else {
        sidebar.style.zIndex = "1";
        sidebar.style.position = "absolute";
        sidebar.style.width = "250px";
        let overlay = document.createElement("div");
        overlay.classList.add("overlay");
        container.appendChild(overlay);
        collapseIcon.style.marginRight = showMargin + "px";
        sidebar.style.marginLeft = "0px";
      }
    }

    window.addEventListener("resize", () => {
      if (window.innerWidth < 750) {
        const width = sidebar.clientWidth;
        sidebar.style.marginLeft = `-${width}px`;
        collapseIcon.style.marginRight = hideMargin + "px";
      } else {
        sidebar.style.marginLeft = "0px";
        collapseIcon.style.marginRight = showMargin + "px";
        // sidebar.style.zIndex = "0";
        sidebar.style.position = "relative";
        let overlay = document.querySelector(".overlay");
        if (overlay) container.removeChild(overlay);
      }
    });

    resizeHandle.addEventListener("mousedown", handleMouseDown);
    document.addEventListener("mouseup", handleMouseUp);
    document.addEventListener("mousemove", handleMouseMove);
    collapseIcon.addEventListener("click", handleCollapse);
  </script>
</html>
